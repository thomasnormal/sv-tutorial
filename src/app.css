@import "tailwindcss";
@plugin "tailwindcss-animate";

@theme {
  /* App color palette — direct color tokens */
  --color-bg:              #f5f1e6;
  --color-bg-accent:       #ece2cc;
  --color-surface:         #fffdf7;
  --color-surface-2:       #efe8d7;
  --color-ink:             #1e2a2c;
  --color-teal:            #0d6f72;   /* primary brand accent (teal) */
  --color-accent-2:        #cc5f2d;

  /* Chip/badge state colors */
  --color-chip-ok-text:    #1c6e3a;
  --color-chip-ok-bg:      #e6f6ea;
  --color-chip-ok-border:  #9fd4ac;
  --color-chip-bad-text:   #8b2f2f;
  --color-chip-bad-bg:     #ffeaea;
  --color-chip-bad-border: #efb1b1;

  /* Component-specific colors */
  --color-tab-selected-bg: #e7f6f4;
  --color-editor-bg:       #faf7ef;
  --color-editor-text:     #162123;
  --color-logs-bg:         #141f23;
  --color-logs-text:       #d7ffe1;
  --color-wave-bg:         #fff4ef;
  --color-wave-text:       #6f3b21;

  --shadow-app: 0 8px 22px rgba(33, 30, 21, 0.12);
  --font-sans:  'IBM Plex Sans', 'Avenir Next', 'Helvetica Neue', sans-serif;
  --font-mono:  'IBM Plex Mono', 'Menlo', 'Consolas', monospace;

  /* Custom breakpoint for max-width responsive design */
  --breakpoint-narrow: 61.25rem;
}

/*
 * Bridge shadcn-svelte's :root CSS variables (space-separated RGB channels)
 * into Tailwind utility classes. `@theme inline` keeps these as dynamic
 * var() references so they follow the :root values at runtime.
 */
@theme inline {
  --color-background:           rgb(var(--background));
  --color-foreground:           rgb(var(--foreground));
  --color-card:                 rgb(var(--card));
  --color-card-foreground:      rgb(var(--card-foreground));
  --color-popover:              rgb(var(--background));
  --color-popover-foreground:   rgb(var(--foreground));
  --color-primary:              rgb(var(--primary));
  --color-primary-foreground:   rgb(var(--primary-foreground));
  --color-secondary:            rgb(var(--secondary));
  --color-secondary-foreground: rgb(var(--secondary-foreground));
  --color-muted:                rgb(var(--muted));
  --color-muted-foreground:     rgb(var(--muted-foreground));
  --color-accent:               rgb(var(--accent));
  --color-accent-foreground:    rgb(var(--accent-foreground));
  --color-destructive:          rgb(var(--destructive));
  --color-destructive-foreground: rgb(var(--destructive-foreground));
  --color-border:               rgb(var(--border));
  --color-input:                rgb(var(--input));
  --color-ring:                 rgb(var(--ring));

  /* Sidebar tokens — map to our app palette so the Sidebar component is themed */
  --color-sidebar:                      var(--color-surface);
  --color-sidebar-foreground:           var(--color-ink);
  --color-sidebar-border:               rgb(var(--border));
  --color-sidebar-accent:               var(--color-surface-2);
  --color-sidebar-accent-foreground:    var(--color-ink);
  --color-sidebar-primary:              var(--color-teal);
  --color-sidebar-primary-foreground:   var(--color-surface);
  --color-sidebar-ring:                 var(--color-teal);
}

@layer base {
  *, *::before, *::after {
    box-sizing: border-box;
  }

  :root {
    line-height: 1.35;

    /* shadcn-svelte CSS variable theme — RGB channel values for opacity composing */
    --background:           255 253 247;   /* --color-surface */
    --foreground:           30 42 44;      /* --color-ink */
    --card:                 255 253 247;
    --card-foreground:      30 42 44;
    --primary:              13 111 114;    /* teal */
    --primary-foreground:   255 253 247;
    --secondary:            239 232 215;   /* --color-surface-2 */
    --secondary-foreground: 30 42 44;
    --muted:                239 232 215;   /* surface hover / muted bg */
    --muted-foreground:     88 100 105;    /* muted text */
    --accent:               239 232 215;   /* hover surface */
    --accent-foreground:    30 42 44;
    --destructive:          139 47 47;
    --destructive-foreground: 255 253 247;
    --border:               213 203 178;   /* #d5cbb2 */
    --input:                213 203 178;
    --ring:                 13 111 114;    /* teal */
    --radius:               0.625rem;
  }

  html.dark {
    --color-bg:        #1b1f1e;
    --color-bg-accent: #141918;
    --color-surface:   #232928;
    --color-surface-2: #2d3532;
    --color-ink:       #dde8e3;
    --color-teal:      #3db5b9;
    --color-tab-selected-bg: #1a3535;
    --color-editor-bg:  #1e2422;
    --color-editor-text: #d4e8e0;

    --background:           35 41 40;
    --foreground:           221 232 227;
    --card:                 35 41 40;
    --card-foreground:      221 232 227;
    --primary:              61 181 185;
    --primary-foreground:   27 31 30;
    --secondary:            45 53 50;
    --secondary-foreground: 221 232 227;
    --muted:                45 53 50;
    --muted-foreground:     140 165 158;
    --accent:               45 53 50;
    --accent-foreground:    221 232 227;
    --destructive:          180 70 70;
    --destructive-foreground: 221 232 227;
    --border:               56 69 67;
    --input:                56 69 67;
    --ring:                 61 181 185;
  }

  body {
    margin: 0;
    font-family: var(--font-sans);
    color: var(--color-ink);
    background:
      radial-gradient(circle at 15% 10%, #fff5d6 0%, transparent 30%),
      radial-gradient(circle at 90% 90%, #d8eee8 0%, transparent 35%),
      linear-gradient(180deg, var(--color-bg), var(--color-bg-accent));
  }

  html.dark body {
    background:
      radial-gradient(circle at 15% 10%, #1f2e2b 0%, transparent 30%),
      radial-gradient(circle at 90% 90%, #131e21 0%, transparent 35%),
      linear-gradient(180deg, var(--color-bg), var(--color-bg-accent));
  }

  button, select, textarea { font: inherit; }

  /* ── Lesson body — targets {@html} injected content, must be global ──── */
  .lesson-body {
    font-size: 0.9rem;
    line-height: 1.55;
  }

  .lesson-body p + p { margin-top: 0.65rem; }

  .lesson-body ul,
  .lesson-body ol {
    padding-left: 1.4rem;
    margin: 0.5rem 0;
  }

  .lesson-body ul { list-style-type: disc; }
  .lesson-body ol { list-style-type: decimal; }

  .lesson-body li + li { margin-top: 0.3rem; }

  /* Inline code */
  .lesson-body code {
    font-family: var(--font-mono);
    font-size: 0.83em;
    background: var(--color-surface-2);
    border: 1px solid var(--color-border);
    border-radius: 3px;
    padding: 0.1em 0.35em;
  }

  /* Fenced code blocks */
  .lesson-body pre {
    background: var(--color-surface-2);
    border: 1px solid var(--color-border);
    border-radius: 6px;
    padding: 0.75rem 1rem;
    font-family: var(--font-mono);
    font-size: 0.82rem;
    line-height: 1.55;
    overflow-x: auto;
    margin: 0.75rem 0;
  }

  .lesson-body pre code {
    background: none;
    border: none;
    padding: 0;
    font-size: inherit;
  }

  /* Note / callout blockquote */
  .lesson-body blockquote {
    background: #e9f5f5;
    border-left: 3px solid var(--color-teal);
    border-radius: 0 6px 6px 0;
    padding: 0.55rem 0.85rem;
    margin: 0.75rem 0;
    color: #134f52;
  }

  .lesson-body blockquote p + p { margin-top: 0.4rem; }

  .lesson-body dfn[data-card] {
    font-style: normal;
    border-bottom: 1px dotted var(--color-teal);
    cursor: help;
  }

  .lesson-body a {
    color: var(--color-teal);
    text-decoration: underline;
    text-underline-offset: 2px;
  }

  .lesson-body strong { font-weight: 600; }

  .lesson-body h2 {
    font-size: 0.95rem;
    font-weight: 600;
    margin: 1.1rem 0 0.35rem;
    color: rgb(var(--foreground));
  }

  .lesson-body h3 {
    font-size: 0.88rem;
    font-weight: 600;
    margin: 0.9rem 0 0.25rem;
    color: rgb(var(--foreground));
  }

  .lesson-body hr {
    border: none;
    border-top: 1px solid rgb(var(--border));
    margin: 1rem 0;
  }
}
